gdocs2md
========

A derivate of a simple Google Apps script forked originally from https://github.com/mangini/gdocs2md to convert an appropriately formatted Google Drive Document to as OU-XML. 

## Usage
 
  * Adding this script to your doc: 
    * Tools > Script Editor > New
    * Select "Blank Project"
    * Clear the example code and paste in the contents of [converttoOUXML.gapps](https://raw.github.com/psychemedia/gdocs2md/master/converttoOUXML.gapps)
    * Create a new HTML file called *metadata* and copy and paste in the contents of *metadata.html*
    * Save with an appropriate project name, eg *md exporter*
    * Reload the original doc
    
  * Running the script (first run of each function will require you to authorize it):
    * In the Add-Ons menu, find the new menu eg "gdoc2OUXML"
    * Select "Metadata" to open a form that allows you to set various metadata properties that are either required or expected in the OUXML
    * Select "Email OUXML" to email markdown doc and saved images to yourself
        *  Converted doc  with images attached will be mailed to you. Subject will be "[OUXML_MAKER]..."
    * Select "Save OUXML to GDrive" to save markdown doc and images to your Google Drive
        * A new folder with same name as original doc will be created containing the OUXML document and image files
    * Select "Save OUXML to GDrive (zip)" to save a zip file containing the XML and any images in one bundle. The zip file will be saves to the top level of your Google Drive account. 



## Interpreted formats
  * Text:
    * paragraphs are separated by two newlines
    * text styled as heading 1, 2, 3, etc is converted to Markdown heading: #, ##, ###, etc
    * text formatted with Courier New is backquoted: ``text``
    * links are converted to MD format: `[anchortext](url)`
  * Lists:
    * Numbered lists are converted correctly, including nested lists
    * bullet lists are converted to "`*`" Markdown format appropriately, including nested lists
  * Images:
    * images are correctly extracted and sent as attachments
  * Blocks:
    * Table of contents is replaced by `[[TOC]]`
    * blocks of text delimited by "--- class whateverclassnameyouwant" and "---" are converted to `<div class="whateverclassnameyouwant"></div>` 
    * Source code: 
      * **UPDATED**: blocks of text delimited by "--- source code" or "--- src" and "---" are converted to `<pre></pre>`
      * **NEW**: blocks of text delimited by "--- source pretty" or "--- srcp" and "---" are converted to `<pre class="prettyprint"></pre>`
    * Tables:
      * **NEW**: Simple `<table>` processing
  * "--- jsperf `<testID>`" is replaced by an iframe that shows an interactive chart of a JSPerf test. The `<testID>` is the last part of the URL of the Browserscope anchor in your JSPerf test. Something like `"agt1YS1wcm9maWxlcnINCxIEVGVzdBjlm_EQDA"` in the URL `http://www.browserscope.org/user/tests/table/agt1YS1wcm9maWxlcnINCxIEVGVzdBjlm_EQDA`
 


## CONTRIBUTORS

* Renato Mangini - [G+](//google.com/+renatomangini) - [Github](//github.com/mangini)
* Ed Bacher - [G+](//plus.google.com/106923847899206957842) - [Github](//github.com/evbacher)

* Tony Hirst - [Github](//github.com/psychemedia)

## LICENSE

Use this script at your will, on any document you want and for any purpose, commercial or not. 
The MarkDown files generated by this script are not considered derivative work and 
don't require any attribution to the owners of this script. 

If you want to modify and redistribute the script (not the converted documents - those are yours), just keep a reference to this repo or to the license info below:

```
Original content: Copyright 2013 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```
